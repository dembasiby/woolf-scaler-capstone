_format_version: "3.0"
_transform: true

services:
  - name: product-service
    url: http://product-service:8082
    routes:
      - name: product-routes
        paths:
          - /api/products
        strip_path: true
        methods:
          - GET
          - POST
          - PUT
          - DELETE
          - OPTIONS

  - name: cart-service
    url: http://cart-service:8084
    routes:
      - name: cart-routes
        paths:
          - /api/carts
        strip_path: true
        methods:
          - GET
          - POST
          - PUT
          - DELETE
          - OPTIONS
  - name: order-service
    url: http://order-service:8086
    routes:
      - name: order-routes
        paths:
          - /api/orders
        strip_path: true
        methods:
          - GET
          - POST
          - PUT
          - DELETE
          - OPTIONS

  - name: payment-service
    url: http://payment-service:8088
    routes:
      - name: payment-routes
        paths:
          - /api/payments
        strip_path: true
        methods:
          - GET
          - POST
          - PUT
          - DELETE
          - OPTIONS

  - name: notification-service
    url: http://notification-service:8090
    routes:
      - name: notification-routes
        paths:
          - /api/notifications
        strip_path: true
        methods:
          - GET
          - POST
          - PUT
          - DELETE
          - OPTIONS

  - name: user-service
    url: http://user-service:8081
    routes:
      - name: user-routes
        paths:
          - /api/users
        strip_path: true
        methods:
          - GET
          - POST
          - PUT
          - DELETE
          - OPTIONS

plugins:
  - name: proxy-cache
    config:
      content_type:
        - application/json
      cache_ttl: 60
      strategy: memory
      request_method:
        - GET
      response_code:
        - 200
      vary_headers:
        - Authorization